"use strict";(self.webpackChunkkrozac_github_io=self.webpackChunkkrozac_github_io||[]).push([[13,35,136,256,436,443,675,708,709,713,722],{443:(t,e,i)=>{function n(){return{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}i.r(e),i.d(e,{AccelerationComponent:()=>n})},713:(t,e,i)=>{function n(){return{maxSpeed:4,minSpeed:3,turnFactor:.2,visualRange:40,protectedRange:8}}i.r(e),i.d(e,{BoidComponent:()=>n})},709:(t,e,i)=>{function n(){return{color:arguments.length>0&&void 0!==arguments[0]?arguments[0]:"black",size:arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,shape:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"circle"}}i.r(e),i.d(e,{DrawComponent:()=>n})},136:(t,e,i)=>{function n(){return{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}i.r(e),i.d(e,{PositionComponent:()=>n})},256:(t,e,i)=>{function n(){return{x:arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,y:arguments.length>1&&void 0!==arguments[1]?arguments[1]:0}}i.r(e),i.d(e,{VelocityComponent:()=>n})},35:(t,e,i)=>{i.r(e),i.d(e,{BoidEntity:()=>c});var n=i(713),o=i(136),a=i(256),s=i(443),r=i(709);class c{constructor(t,e,i){this.entityId=t.createEntity(),t.addComponent(this.entityId,"Boid",(0,n.BoidComponent)()),t.addComponent(this.entityId,"Position",(0,o.PositionComponent)(e,i)),t.addComponent(this.entityId,"Velocity",(0,a.VelocityComponent)()),t.addComponent(this.entityId,"Acceleration",(0,s.AccelerationComponent)()),t.addComponent(this.entityId,"Draw",(0,r.DrawComponent)("white",5,"triangle"))}}},13:(t,e,i)=>{i.r(e),i.d(e,{EntityManager:()=>n});class n{constructor(){this.entities=new Map,this.nextEntityId=0}createEntity(){const t=this.nextEntityId++;return this.entities.set(t,new Map),t}addComponent(t,e,i){const n=this.entities.get(t);n&&n.set(e,i)}getComponent(t,e){const i=this.entities.get(t);return i?i.get(e):void 0}getEntities(){return this.entities}}},722:(t,e,i)=>{i.r(e),i.d(e,{gameLoop:()=>f,init:()=>l});var n=i(13),o=i(35),a=i(708),s=i(675),r=i(436);let c,h,d,y,p,g;function l(t,e){p=t.canvas.width,g=t.canvas.height,c=new n.EntityManager,h=new a.BoidSystem(c,p,g),d=new s.MovementSystem,y=new r.DrawSystem(t);for(let i=0;i<e;i++){new o.BoidEntity(c,Math.random()*p,Math.random()*g)}}let x=0;const m=1e3/60;let u=0;function f(t){for(x||(x=t),u+=t-x,x=t;u>=m;)h.update(),d.update(c,p,g),u-=m;y.update(c),requestAnimationFrame(f)}},708:(t,e,i)=>{i.r(e),i.d(e,{BoidSystem:()=>n});class n{constructor(t,e,i){this.entityManager=t,this.boidParams={separationFactor:.05,alignmentFactor:.05,centeringFactor:5e-4},this.canvaswidth=e,this.canvasheight=i}update(){this.entityManager.getEntities().forEach(((t,e)=>{const i=t.get("Boid"),n=t.get("Position"),o=t.get("Velocity"),a=t.get("Acceleration");i&&n&&o&&a&&(this.applyupdate(e,n,o,i,a),this.applySeparation(e,n,o,i),this.applyAlignment(e,n,o,i),this.applyCentering(e,n,o,i))}))}applyupdate(t,e,i,n,o){i.x+=o.x,i.y+=o.y;const a=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));a>n.maxSpeed?(i.x=i.x/a*n.maxSpeed,i.y=i.y/a*n.maxSpeed):a<n.minSpeed&&0!==a?(i.x=i.x/a*n.minSpeed,i.y=i.y/a*n.minSpeed):0===a&&(i.x=n.minSpeed,i.y=n.minSpeed),e.x<this.canvaswidth&&(i.x+=n.turnFactor),e.x>0&&(i.x-=n.turnFactor),e.y<this.canvasheight&&(i.y+=n.turnFactor),e.y>0&&(i.y-=n.turnFactor),o.x=0,o.y=0}applySeparation(t,e,i,n){const o=this.entityManager.getEntities();let a={dx:0,dy:0};o.forEach(((i,o)=>{if(t!==o){const t=i.get("Position"),o=i.get("Boid");if(t&&o){const i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));i<n.protectedRange&&i>0&&(a.dx+=e.x-t.x,a.dy+=e.y-t.y)}}})),i.x+=a.dx*this.boidParams.separationFactor,i.y+=a.dy*this.boidParams.separationFactor}applyAlignment(t,e,i,n){let o=0,a=0,s=0;this.entityManager.getEntities().forEach(((i,r)=>{if(t!==r){const t=i.get("Position"),r=i.get("Boid"),c=i.get("Velocity");if(t&&r&&c){const i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));i<n.visualRange&&i>0&&(o+=c.x,a+=c.y,s++)}}})),s>0&&(o/=s,a/=s),i.x+=(o-i.x)*this.boidParams.alignmentFactor,i.y+=(a-i.y)*this.boidParams.alignmentFactor}applyCentering(t,e,i,n){let o=0,a=0,s=0;this.entityManager.getEntities().forEach(((i,r)=>{if(t!==r){const t=i.get("Position"),r=i.get("Boid");if(t&&r){const i=Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2));i<n.visualRange&&i>0&&(o+=t.x,a+=t.y,s++)}}})),s>0&&(o/=s,a/=s),i.x+=(o-e.x)*this.boidParams.centeringFactor,i.y+=(a-e.y)*this.boidParams.centeringFactor}}},436:(t,e,i)=>{i.r(e),i.d(e,{DrawSystem:()=>n});class n{constructor(t){this.context=t}update(t){const e=t.getEntities();this.context.clearRect(0,0,this.context.canvas.width,this.context.canvas.height),e.forEach(((t,e)=>{const i=t.get("Position"),n=t.get("Draw"),o=t.get("Velocity");if(i&&n&&o){if(this.context.fillStyle=n.color,this.context.beginPath(),"circle"===n.shape)this.context.arc(i.x,i.y,n.size,0,2*Math.PI);else if("square"===n.shape)this.context.rect(i.x-n.size/2,i.y-n.size/2,n.size,n.size);else if("triangle"===n.shape){const t=Math.atan2(o.y,o.x);this.context.save(),this.context.translate(i.x,i.y),this.context.rotate(t),this.context.beginPath(),this.context.moveTo(0,-n.size),this.context.lineTo(-n.size,n.size),this.context.lineTo(2*n.size,n.size),this.context.closePath(),this.context.restore()}this.context.fill()}}))}}},675:(t,e,i)=>{i.r(e),i.d(e,{MovementSystem:()=>n});class n{update(t,e,i){t.getEntities().forEach(((t,e)=>{const i=t.get("Position"),n=t.get("Velocity");i&&n&&(i.x+=n.x,i.y+=n.y)}))}}}}]);
//# sourceMappingURL=722.43371936.chunk.js.map
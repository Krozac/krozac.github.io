"use strict";(self.webpackChunkkrozac_github_io=self.webpackChunkkrozac_github_io||[]).push([[708],{708:(t,a,i)=>{i.r(a),i.d(a,{BoidSystem:()=>e});class e{constructor(t,a,i){this.entityManager=t,this.boidParams={separationFactor:.05,alignmentFactor:.05,centeringFactor:5e-4},this.canvaswidth=a,this.canvasheight=i}update(){this.entityManager.getEntities().forEach(((t,a)=>{const i=t.get("Boid"),e=t.get("Position"),n=t.get("Velocity"),o=t.get("Acceleration");i&&e&&n&&o&&(this.applyupdate(a,e,n,i,o),this.applySeparation(a,e,n,i),this.applyAlignment(a,e,n,i),this.applyCentering(a,e,n,i))}))}applyupdate(t,a,i,e,n){i.x+=n.x,i.y+=n.y;const o=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));o>e.maxSpeed?(i.x=i.x/o*e.maxSpeed,i.y=i.y/o*e.maxSpeed):o<e.minSpeed&&0!==o?(i.x=i.x/o*e.minSpeed,i.y=i.y/o*e.minSpeed):0===o&&(i.x=e.minSpeed,i.y=e.minSpeed),a.x<this.canvaswidth&&(i.x+=e.turnFactor),a.x>0&&(i.x-=e.turnFactor),a.y<this.canvasheight&&(i.y+=e.turnFactor),a.y>0&&(i.y-=e.turnFactor),n.x=0,n.y=0}applySeparation(t,a,i,e){const n=this.entityManager.getEntities();let o={dx:0,dy:0};n.forEach(((i,n)=>{if(t!==n){const t=i.get("Position"),n=i.get("Boid");if(t&&n){const i=Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));i<e.protectedRange&&i>0&&(o.dx+=a.x-t.x,o.dy+=a.y-t.y)}}})),i.x+=o.dx*this.boidParams.separationFactor,i.y+=o.dy*this.boidParams.separationFactor}applyAlignment(t,a,i,e){let n=0,o=0,s=0;this.entityManager.getEntities().forEach(((i,r)=>{if(t!==r){const t=i.get("Position"),r=i.get("Boid"),h=i.get("Velocity");if(t&&r&&h){const i=Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));i<e.visualRange&&i>0&&(n+=h.x,o+=h.y,s++)}}})),s>0&&(n/=s,o/=s),i.x+=(n-i.x)*this.boidParams.alignmentFactor,i.y+=(o-i.y)*this.boidParams.alignmentFactor}applyCentering(t,a,i,e){let n=0,o=0,s=0;this.entityManager.getEntities().forEach(((i,r)=>{if(t!==r){const t=i.get("Position"),r=i.get("Boid");if(t&&r){const i=Math.sqrt(Math.pow(a.x-t.x,2)+Math.pow(a.y-t.y,2));i<e.visualRange&&i>0&&(n+=t.x,o+=t.y,s++)}}})),s>0&&(n/=s,o/=s),i.x+=(n-a.x)*this.boidParams.centeringFactor,i.y+=(o-a.y)*this.boidParams.centeringFactor}}}}]);
//# sourceMappingURL=708.c22bf0b6.chunk.js.map